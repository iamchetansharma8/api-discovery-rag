{
    "swagger": "2.0",
    "info": {
        "description": "This page lists all the rest apis for Payout Service",
        "version": "1.0-SNAPSHOT",
        "title": "Payout Service APIs"
    },
    "host": "https://api.natwest.com",
    "basePath": "/sending-payments/v1.0",
    "tags": [
        {
            "name": "payout-controller",
            "description": "Payout Controller"
        }
    ],
    "paths": {
        "/merchant/payouts": {
            "post": {
                "tags": [
                    "payout-controller"
                ],
                "summary": "Create payout request",
                "operationId": "payoutInitiationUsingPOST",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "*/*"
                ],
                "parameters": [
                    {
                        "in": "body",
                        "name": "payoutInitiationRequest",
                        "description": "Details of a payout requests",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/PayoutInitiationRequest"
                        }
                    },
                    {
                        "name": "x-fapi-interaction-id",
                        "in": "header",
                        "description": "x-fapi-interaction-id",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "x-idempotency-key",
                        "in": "header",
                        "description": "x-idempotency-key",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "x-jws-signature",
                        "in": "header",
                        "description": "x-jws-signature",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Payout request has been accepted",
                        "schema": {
                            "$ref": "#/definitions/payoutResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/Error Response"
                        }
                    },
                    "401": {
                        "description": "User not authorised"
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/Error Response Internal"
                        }
                    }
                },
                "deprecated": false
            }
        },
        "/merchant/payouts/{payoutId}": {
            "get": {
                "tags": [
                    "payout-controller"
                ],
                "summary": "Get payout status by payout id",
                "operationId": "getPayoutStatusUsingGET",
                "produces": [
                    "*/*"
                ],
                "parameters": [
                    {
                        "name": "payoutId",
                        "in": "path",
                        "description": "tokenId of the payout payment request",
                        "required": true,
                        "type": "string",
                        "x-example": "kfghdfkjgui78gdhft"
                    },
                    {
                        "name": "x-fapi-interaction-id",
                        "in": "header",
                        "description": "x-fapi-interaction-id",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "x-jws-signature",
                        "in": "header",
                        "description": "x-jws-signature",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Payout Status fetched",
                        "schema": {
                            "$ref": "#/definitions/statusEnquiryResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request. E.g. If Payout id is wrong",
                        "schema": {
                            "$ref": "#/definitions/Error Response Generic"
                        }
                    },
                    "401": {
                        "description": "User not authorised"
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/Error Response Internal"
                        }
                    }
                },
                "deprecated": false
            }
        },
        "/merchant/payouts/{payoutId}/cancel": {
            "put": {
                "tags": [
                    "payout-controller"
                ],
                "summary": "Cancel payout by payout id",
                "operationId": "cancelPayoutUsingPUT",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "*/*"
                ],
                "parameters": [
                    {
                        "name": "payoutId",
                        "in": "path",
                        "description": "Unique identifier of the payout",
                        "required": true,
                        "type": "string",
                        "x-example": "kfghdfkjgui78gdhft"
                    },
                    {
                        "name": "x-fapi-interaction-id",
                        "in": "header",
                        "description": "x-fapi-interaction-id",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "x-jws-signature",
                        "in": "header",
                        "description": "x-jws-signature",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK - Payout Cancelled",
                        "schema": {
                            "$ref": "#/definitions/ManagePayoutResponse-Cancel"
                        }
                    },
                    "400": {
                        "description": "Bad Request. E.g. If Payout id is wrong or Action not supported",
                        "schema": {
                            "$ref": "#/definitions/Error Response Generic"
                        }
                    },
                    "401": {
                        "description": "User not authorised"
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/Error Response Internal"
                        }
                    }
                },
                "deprecated": false
            }
        },
        "/merchant/payouts/{payoutId}/unlock": {
            "put": {
                "tags": [
                    "payout-controller"
                ],
                "summary": "Unlock payout request in payment journey",
                "operationId": "unlockPayoutUsingPUT",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "*/*"
                ],
                "parameters": [
                    {
                        "name": "payoutId",
                        "in": "path",
                        "description": "Unique identifier of the payout",
                        "required": true,
                        "type": "string",
                        "x-example": "hkfsdfkjh863ruery"
                    },
                    {
                        "name": "x-fapi-interaction-id",
                        "in": "header",
                        "description": "x-fapi-interaction-id",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "x-jws-signature",
                        "in": "header",
                        "description": "x-jws-signature",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Payout Status updated",
                        "schema": {
                            "$ref": "#/definitions/ManagePayoutResponse-Unlock"
                        }
                    },
                    "400": {
                        "description": "Bad Request. E.g. If Payout id is wrong or Action not supported",
                        "schema": {
                            "$ref": "#/definitions/Error Response Generic"
                        }
                    },
                    "401": {
                        "description": "User not authorised"
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/Error Response Internal"
                        }
                    }
                },
                "deprecated": false
            }
        },
        "/merchant/payouts/{payoutId}/sendReminder": {
            "put": {
                "tags": [
                    "payout-controller"
                ],
                "summary": "Send reminder: to send the Payment link again as a Reminder Email",
                "operationId": "sendReminderPayoutUsingPUT",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "*/*"
                ],
                "parameters": [
                    {
                        "name": "payoutId",
                        "in": "path",
                        "description": "Unique identifier of the payout",
                        "required": true,
                        "type": "string",
                        "x-example": "hkfsdfkjh863ruery"
                    },
                    {
                        "name": "x-fapi-interaction-id",
                        "in": "header",
                        "description": "x-fapi-interaction-id",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "x-jws-signature",
                        "in": "header",
                        "description": "x-jws-signature",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Payout reminder sent",
                        "schema": {
                            "$ref": "#/definitions/ManagePayoutResponse-sendReminder"
                        }
                    },
                    "400": {
                        "description": "Bad Request. E.g. If Payout id is wrong or Action not supported",
                        "schema": {
                            "$ref": "#/definitions/Error Response Generic"
                        }
                    },
                    "401": {
                        "description": "User not authorised"
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/Error Response Internal"
                        }
                    }
                },
                "deprecated": false
            }
        }
    },
    "definitions": {
        "payoutResponse": {
            "type": "object",
            "properties": {
                "customerpayoutStatus": {
                    "description": "payout details",
                    "$ref": "#/definitions/CustomerpayoutStatus"
                }
            },
            "title": "payoutResponse",
            "description": "Payout details to be shared in response"
        },
        "CustomerpayoutStatus": {
            "type": "object",
            "required": [
                "payoutId"
            ],
            "properties": {
                "payoutId": {
                    "type": "string",
                    "example": "hjsajds84efefdhf8fdsu",
                    "description": "Unique payout identifier"
                },
                "creationDateTime": {
                    "type": "string",
                    "format": "date-time",
                    "example": "2021-06-17T12:34:45Z",
                    "description": "Creation time for this payout. It's in UTC Date and time (ISO-8601 format)"
                },
                "status": {
                    "type": "string",
                    "example": "OPEN",
                    "description": "Current status of payout"
                },
                "payoutInformation": {
                    "description": "Details of payout",
                    "$ref": "#/definitions/PayoutResponse"
                },
                "claimUrl": {
                    "type": "string",
                    "example": "https://sendmoney.natwest.co.uk/sending-payments/home/10933e1e-331b-1b97-1a79-5b2eeea843b4/payout#/8909plbafqnrgfl3t78c3vp5s9uo4b54s3peicihu8svr16864t/secret",
                    "description": "Link available for customer's payout claim journey"
                }
            },
            "title": "CustomerpayoutStatus"
        },
        "CustomerPayoutStatus": {
            "type": "object",
            "required": [
                "payoutId"
            ],
            "properties": {
                "payoutId": {
                    "type": "string",
                    "example": "hjsajds84efefdhf8fdsu",
                    "description": "Unique payout identifier"
                },
                "creationDateTime": {
                    "type": "string",
                    "format": "date-time",
                    "example": "2021-06-17T12:34:45Z",
                    "description": "Creation time for this payout"
                },
                "status": {
                    "type": "string",
                    "example": "OPEN",
                    "description": "Current status of payout",
                    "enum": [
                        "CREATED",
                        "OPEN",
                        "VIEWED",
                        "VALIDATION_SUCCESS",
                        "PIN_VALIDATION_SUCCESS",
                        "SUBMITTING",
                        "AWAITING_ACKNOWLEDGEMENT",
                        "SENT",
                        "FAILED",
                        "VALIDATION_FAILED",
                        "PIN_VALIDATION_FAILED",
                        "PIN_EXPIRED",
                        "COP_CHECK_MATCH",
                        "COP_CHECK_CLOSE_MATCH",
                        "COP_CHECK_NO_MATCH",
                        "LOCKED",
                        "PIN_LOCKED",
                        "UNLOCKED",
                        "CANCELLED",
                        "EXPIRED"
                    ]
                },
                "statusUpdateDateTime": {
                    "type": "string",
                    "format": "date-time",
                    "example": "2021-06-17T12:34:45Z",
                    "description": "Payment status update time for this payout"
                },
                "payoutInformation": {
                    "description": "Details of payout",
                    "$ref": "#/definitions/PayoutResponse"
                },
                "payoutStatus": {
                    "type": "array",
                    "description": "Payout status array. All updated status of this payout with details",
                    "items": {
                        "$ref": "#/definitions/PayoutStatus"
                    }
                }
            },
            "title": "CustomerPayoutStatus"
        },
        "Error Response": {
            "type": "object",
            "properties": {
                "status": {
                    "type": "string",
                    "example": "BAD_REQUEST",
                    "description": "Errror Status"
                },
                "timestamp": {
                    "type": "string",
                    "example": "2021-06-28T13:09:41.347Z",
                    "description": "Time of error"
                },
                "message": {
                    "type": "string",
                    "example": "Invalid request parameters",
                    "description": "Error messgae string"
                },
                "errors": {
                    "type": "array",
                    "description": "List of error with",
                    "items": {
                        "$ref": "#/definitions/ErrorDetails"
                    }
                }
            },
            "title": "Error Response"
        },
        "ErrorDetails": {
            "type": "object",
            "properties": {
                "errorCode": {
                    "type": "string",
                    "example": "Payout.Field.Invalid",
                    "description": "Related error code"
                },
                "field": {
                    "type": "string",
                    "example": "uniqueIdentifier",
                    "description": "Error field in the request"
                },
                "message": {
                    "type": "string",
                    "example": "The uniqueIdentifier field must conform to the following pattern \"^[a-zA-Z0-9/&.-]*$\"",
                    "description": "Error messgae string"
                },
                "rejectedValue": {
                    "type": "object",
                    "example": "987547u98",
                    "description": "Passed wrong value"
                }
            },
            "title": "ErrorDetails"
        },
        "Error Response Generic": {
            "type": "object",
            "properties": {
                "status": {
                    "type": "string",
                    "example": "PAYOUT_NOT_FOUND",
                    "description": "Errror Status"
                },
                "timestamp": {
                    "type": "string",
                    "example": "2021-06-28T13:09:41.347Z",
                    "description": "Time of error"
                },
                "message": {
                    "type": "string",
                    "example": "Payout with supplied id does not exist.",
                    "description": "Error messgae string"
                }
            },
            "title": "Generic Error Response"
        },
        "Error Response Internal": {
            "type": "object",
            "properties": {
                "status": {
                    "type": "string",
                    "example": "INTERNAL_SERVER_ERROR",
                    "description": "Errror Status"
                },
                "timestamp": {
                    "type": "string",
                    "example": "2021-06-28T13:09:41.347Z",
                    "description": "Time of error"
                },
                "message": {
                    "type": "string",
                    "example": "Connection Error",
                    "description": "Error message string"
                }
            },
            "title": "Internal Error Response"
        },
        "ManagePayoutResponse-Unlock": {
            "type": "object",
            "required": [
                "payoutId",
                "status"
            ],
            "properties": {
                "payoutId": {
                    "type": "string",
                    "example": "jdfgj748587hdsf7e98tf",
                    "description": "Requested unique payout id"
                },
                "status": {
                    "type": "string",
                    "example": "UNLOCKED",
                    "description": "Status of payout if status is updated"
                }
            },
            "title": "ManagePayoutResponse - Unlock",
            "description": "Updated payout status for Unlock"
        },
        "ManagePayoutResponse-sendReminder": {
            "type": "object",
            "required": [
                "payoutId",
                "status",
                "ackMsg"
            ],
            "properties": {
                "payoutId": {
                    "type": "string",
                    "example": "jdfgj748587hdsf7e98tf",
                    "description": "Requested unique payout id"
                },
                "status": {
                    "type": "string",
                    "example": "OPEN",
                    "description": "Status of payout",
                    "enum": [
                        "OPEN",
                        "VIEWED",
                        "VALIDATION_SUCCESS",
                        "PIN_VALIDATION_SUCCESS",
                        "VALIDATION_FAILED",
                        "PIN_VALIDATION_FAILED",
                        "PIN_EXPIRED",
                        "UNLOCKED"
                    ]
                },
                "ackMsg": {
                    "type": "string",
                    "example": "Email sent successfully",
                    "description": "Acknowledgement message string"
                }
            },
            "title": "ManagePayoutResponse - SendReminder",
            "description": "Response for send reminder"
        },
        "ManagePayoutResponse-Cancel": {
            "type": "object",
            "required": [
                "payoutId",
                "status"
            ],
            "properties": {
                "payoutId": {
                    "type": "string",
                    "example": "jdfgj748587hdsf7e98tf",
                    "description": "Requested unique payout id"
                },
                "status": {
                    "type": "string",
                    "example": "CANCELLED",
                    "description": "Status of payout if status is updated"
                }
            },
            "title": "ManagePayoutResponse - Cancel",
            "description": "Updated payout status for Cancel"
        },
        "Payout": {
            "type": "object",
            "required": [
                "templateId",
                "uniqueIdentifier",
                "payeeName",
                "payeeSurname",
                "payeeEmail",
                "payeeMobile",
                "payoutAmount",
                "secretAnswer",
                "payoutReason",
                "expiryDateTime"
            ],
            "properties": {
                "templateId": {
                    "type": "string",
                    "example": "ff37067d-3aaf-4409-97dc-3b4a9c69629f",
                    "description": "The id of the template to be used for Payout",
                    "minLength": 1,
                    "maxLength": 100,
                    "pattern": "^[a-zA-Z0-9/&.-]*$"
                },
                "uniqueIdentifier": {
                    "type": "string",
                    "example": "BMW-CR-1169227",
                    "description": "Unique payout identifier",
                    "minLength": 1,
                    "maxLength": 18,
                    "pattern": "^[a-z A-Z0-9/&.-]*$"
                },
                "payeeName": {
                    "type": "string",
                    "example": "payeeName",
                    "description": "The Name of the person this payout will be sent to",
                    "minLength": 1,
                    "maxLength": 18,
                    "pattern": "^[a-z A-Z0-9/&'.-]*$"
                },
                "payeeSurname": {
                    "type": "string",
                    "example": "SurName",
                    "description": "The SurName of the person this payout will be sent to",
                    "minLength": 1,
                    "maxLength": 36,
                    "pattern": "^[a-z A-Z0-9/&'.-]*$"
                },
                "payeeEmail": {
                    "type": "string",
                    "example": "mail@email.com",
                    "description": "The Email of the person this payout will be sent to",
                    "minLength": 1,
                    "maxLength": 100
                },
                "payeeMobile": {
                    "type": "string",
                    "example": "+447123123123",
                    "description": "The mobile number of the person this payout will be sent to. Used for pin validation",
                    "pattern": "^\\+(?: ?[1-9])(?: ?[0-9]){7,14}$"
                },
                "payoutAmount": {
                    "description": "The Payout Payment amount requested",
                    "$ref": "#/definitions/Payout amount details with Currency and amount"
                },
                "payoutReason": {
                    "type": "string",
                    "description": "A Payment reason to appear on the Payout details. Maximum 50 Characters",
                    "minLength": 1,
                    "maxLength": 50,
                    "pattern": "^[a-z A-Z0-9/&.-]*$"
                },
                "narrative": {
                    "type": "string",
                    "description": "Any additional information related to the Payout. Maximum 35 Characters",
                    "minLength": 1,
                    "maxLength": 35,
                    "pattern": "^[a-z A-Z0-9/&.-]*$"
                },
                "secretAnswer": {
                    "type": "string",
                    "example": "any secret answer",
                    "description": "Secret answer to claim payment",
                    "minLength": 1,
                    "maxLength": 30,
                    "pattern": "^[a-z A-Z0-9/&.-]*$"
                },
                "expiryDateTime": {
                    "type": "string",
                    "format": "date-time",
                    "example": "2021-06-17T12:31:17.123Z",
                    "description": "The expiry date for paying this payout in UTC Date and time (in ISO-8601 format)"
                }
            },
            "title": "Payout"
        },
        "PayoutResponse": {
            "type": "object",
            "required": [
                "templateId",
                "uniqueIdentifier",
                "payeeName",
                "payeeSurname",
                "payeeEmail",
                "payeeMobile",
                "payoutAmount",
                "payoutReason",
                "expiryDateTime"
            ],
            "properties": {
                "templateId": {
                    "type": "string",
                    "example": "ff37067d-3aaf-4409-97dc-3b4a9c69629f",
                    "description": "The id of the template to be used for Payout",
                    "minLength": 1,
                    "maxLength": 100,
                    "pattern": "^[a-zA-Z0-9/&.-]*$"
                },
                "uniqueIdentifier": {
                    "type": "string",
                    "example": "BMW-CR-1169227",
                    "description": "Unique payout identifier",
                    "minLength": 1,
                    "maxLength": 18,
                    "pattern": "^[a-z A-Z0-9/&.-]*$"
                },
                "payeeName": {
                    "type": "string",
                    "example": "payeeName",
                    "description": "The Name of the person this payout will be sent to",
                    "minLength": 1,
                    "maxLength": 18,
                    "pattern": "^[a-z A-Z0-9/&'.-]*$"
                },
                "payeeSurname": {
                    "type": "string",
                    "example": "SurName",
                    "description": "The SurName of the person this payout will be sent to",
                    "minLength": 1,
                    "maxLength": 36,
                    "pattern": "^[a-z A-Z0-9/&'.-]*$"
                },
                "payeeEmail": {
                    "type": "string",
                    "example": "mail@email.com",
                    "description": "The Email of the person this payout will be sent to",
                    "minLength": 1,
                    "maxLength": 100
                },
                "payeeMobile": {
                    "type": "string",
                    "example": "+447123123123",
                    "description": "The mobile number of the person this payout will be sent to. Used for pin validation",
                    "pattern": "^\\+(?: ?[1-9])(?: ?[0-9]){7,14}$"
                },
                "payoutAmount": {
                    "description": "The Payout Payment amount requested",
                    "$ref": "#/definitions/Payout amount details with Currency and amount"
                },
                "payoutReason": {
                    "type": "string",
                    "description": "A Payment reason to appear on the Payout details. Maximum 50 Characters",
                    "minLength": 1,
                    "maxLength": 50,
                    "pattern": "^[a-z A-Z0-9/&.-]*$"
                },
                "narrative": {
                    "type": "string",
                    "description": "Any additional information related to the Payout. Maximum 35 Characters",
                    "minLength": 1,
                    "maxLength": 35,
                    "pattern": "^[a-z A-Z0-9/&.-]*$"
                },
                "expiryDateTime": {
                    "type": "string",
                    "format": "date-time",
                    "example": "2021-06-17T12:31:17.123Z",
                    "description": "The optional expiry date for paying this payout in ISO8601 Format"
                }
            },
            "title": "PayoutResponse"
        },
        "Payout amount details with Currency and amount": {
            "type": "object",
            "required": [
                "amount",
                "currency"
            ],
            "properties": {
                "amount": {
                    "type": "number",
                    "description": "The Payout Payment amount requested",
                    "minimum": 0,
                    "exclusiveMinimum": true
                },
                "currency": {
                    "type": "string",
                    "description": "The Payout Payment currency requested",
                    "pattern": "GBP"
                }
            },
            "title": "Payout amount details with Currency and amount"
        },
        "PayoutInitiation": {
            "type": "object",
            "required": [
                "payoutInformation",
                "sendEmail"
            ],
            "properties": {
                "sendEmail": {
                    "type": "boolean",
                    "description": "Flag for sending email"
                },
                "payoutInformation": {
                    "description": "Details of payout",
                    "$ref": "#/definitions/Payout"
                }
            },
            "title": "PayoutInitiation",
            "description": "Payout initiation data"
        },
        "PayoutInitiationRequest": {
            "type": "object",
            "required": [
                "customerPayoutInitiation"
            ],
            "properties": {
                "customerPayoutInitiation": {
                    "description": "Payout initiation data $object value",
                    "$ref": "#/definitions/PayoutInitiation"
                }
            },
            "title": "PayoutInitiationRequest",
            "description": "A Payout Request payload  for a Merchant "
        },
        "PayoutStatus": {
            "type": "object",
            "properties": {
                "dateTime": {
                    "type": "string",
                    "format": "date-time",
                    "example": "2021-06-17T12:34:45Z",
                    "description": "Payment status update time for this payout"
                },
                "user": {
                    "type": "string",
                    "example": "API User",
                    "description": "Unique Id of user who update status"
                },
                "status": {
                    "type": "string",
                    "example": "CREATED",
                    "enum": [
                        "CREATED",
                        "OPEN",
                        "VIEWED",
                        "VALIDATION_SUCCESS",
                        "PIN_VALIDATION_SUCCESS",
                        "SUBMITTING",
                        "AWAITING_ACKNOWLEDGEMENT",
                        "SENT",
                        "VALIDATION_FAILED",
                        "PIN_VALIDATION_FAILED",
                        "PIN_EXPIRED",
                        "COP_CHECK_MATCH",
                        "COP_CHECK_CLOSE_MATCH",
                        "COP_CHECK_NO_MATCH",
                        "LOCKED",
                        "PIN_LOCKED",
                        "UNLOCKED",
                        "CANCELLED",
                        "EXPIRED"
                    ],
                    "description": "Status hostory of the Payout"
                }
            },
            "title": "PayoutStatus"
        },
        "statusEnquiryResponse": {
            "type": "object",
            "properties": {
                "customerPayoutStatus": {
                    "description": "payout status details",
                    "$ref": "#/definitions/CustomerPayoutStatus"
                }
            },
            "title": "statusEnquiryResponse",
            "description": "A Payout Status details for a Merchant"
        }
    }
}